node
{
def mavenHome= tool name: "maven 3.6.2"
def buildNumber= BUILD_NUMBER
stage("Code checkout")
{
git credentialsId: 'gitcredentials', url: 'https://github.com/navya-devops-applications/spring-mongo-docker.git'
}
stage("Build Packages")
{
sh "${mavenHome}/bin/mvn clean package"
}
stage("Build Image")
{
sh "docker build -t navyadevops/springapp:${buildNumber} ."
}
stage("Authenticating")
{
withCredentials([string(credentialsId: 'Docker_hub_pwd', variable: 'Docker_hub_pwd')]) {
 sh "docker login -u navyadevops -p ${Docker_hub_pwd}"   
}
}
stage("Deploying into kubernetes cluster")
{
withKubeConfig(credentialsId: 'KubeConfig') {
 sh" kubectl apply -f springBootMongo.yml"
}
}
}
